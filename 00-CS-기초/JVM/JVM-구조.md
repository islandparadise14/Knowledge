---
tags: [cs, jvm, memory, android, art]
---

# JVM êµ¬ì¡°

## ğŸ’¡ í•µì‹¬ ê°œë…

**JVM**(Java Virtual Machine)ì€ Java/Kotlin ë°”ì´íŠ¸ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê°€ìƒ ë¨¸ì‹ ì´ë‹¤. í¬ê²Œ **í´ë˜ìŠ¤ ë¡œë”**, **ëŸ°íƒ€ì„ ë°ì´í„° ì˜ì—­**(ë©”ëª¨ë¦¬), **ì‹¤í–‰ ì—”ì§„**ìœ¼ë¡œ êµ¬ì„±ëœë‹¤. AndroidëŠ” í‘œì¤€ JVM ëŒ€ì‹  **ART**(Android Runtime)ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, ë©”ëª¨ë¦¬ êµ¬ì¡°ì˜ ê¸°ë³¸ ê°œë…ì€ ë™ì¼í•˜ë‹¤.

## ğŸ“Œ ì™œ í•„ìš”í•œê°€?

ë©”ëª¨ë¦¬ ë¦­, OOM, ANR ë“± Android ì•±ì˜ ì£¼ìš” ë¬¸ì œë¥¼ ë””ë²„ê¹…í•˜ë ¤ë©´ JVM/ARTì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ ì´í•´í•´ì•¼ í•œë‹¤. ViewModel, Singleton, Coroutine ë“±ì´ ë©”ëª¨ë¦¬ì— ì–´ë–»ê²Œ ë°°ì¹˜ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.

## ğŸ” ìì„¸íˆ

### JVM ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              JVM / ART                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Class Loaderâ”‚  .class / .dex íŒŒì¼ ë¡œë”©   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Runtime Data Area (ë©”ëª¨ë¦¬)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Method   â”‚ â”‚   Heap   â”‚ â”‚  Stack  â”‚ â”‚
â”‚  â”‚  Area    â”‚ â”‚          â”‚ â”‚(per thr)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PC Reg   â”‚ â”‚ Native Method Stack  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Execution Engine                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚Interpreter â”‚ â”‚ JIT â”‚ â”‚    GC    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Runtime Data Area (ë©”ëª¨ë¦¬ ì˜ì—­)

**1. Method Area (ë©”ì„œë“œ ì˜ì—­)**

í´ë˜ìŠ¤ ì •ë³´, static ë³€ìˆ˜, ìƒìˆ˜ í’€ì´ ì €ì¥ë˜ëŠ” ê³µìœ  ì˜ì—­ì´ë‹¤.

```kotlin
class UserRepository {
    companion object {
        // companion objectì˜ í”„ë¡œí¼í‹° â†’ Method Area
        const val TAG = "UserRepository"
        private var instance: UserRepository? = null
    }
}

object AppConfig {
    // object ì„ ì–¸ â†’ Method Areaì— í´ë˜ìŠ¤ ì •ë³´ ì €ì¥
    val baseUrl = "https://api.example.com"
}
```

**2. Heap (í™)**

`new`ë¡œ ìƒì„±ë˜ëŠ” ëª¨ë“  ê°ì²´ê°€ ì €ì¥ëœë‹¤. GCì˜ ëŒ€ìƒì´ ë˜ëŠ” ì˜ì—­.

```kotlin
fun createUser() {
    val user = User("Kim")      // User ê°ì²´ â†’ Heap
    val list = mutableListOf()  // ArrayList ê°ì²´ â†’ Heap
    val bitmap = BitmapFactory.decodeResource(res, R.drawable.img) // â†’ Heap
}
```

**3. Stack (ìŠ¤íƒ) - ìŠ¤ë ˆë“œë§ˆë‹¤ ìƒì„±**

ë©”ì„œë“œ í˜¸ì¶œ ì‹œ í”„ë ˆì„ì´ ìŒ“ì´ê³ , ì§€ì—­ ë³€ìˆ˜ì™€ ì°¸ì¡°ê°’ì´ ì €ì¥ëœë‹¤.

```kotlin
fun main() {                    // í”„ë ˆì„ 1 push
    val x = 10                  // x â†’ Stack (ì›ì‹œ ê°’)
    val user = getUser()        // getUser í”„ë ˆì„ 2 push â†’ ë°˜í™˜ í›„ pop
    println(user.name)
}                               // í”„ë ˆì„ 1 pop

fun getUser(): User {           // í”„ë ˆì„ 2
    val user = User("Park")    // user ì°¸ì¡° â†’ Stack, User ê°ì²´ â†’ Heap
    return user                // í”„ë ˆì„ pop ì‹œ ì§€ì—­ë³€ìˆ˜ ì‚¬ë¼ì§, Heap ê°ì²´ëŠ” ìœ ì§€
}
```

**4. PC Register**

í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ëª…ë ¹ì–´ì˜ ì£¼ì†Œë¥¼ ì €ì¥í•œë‹¤. ìŠ¤ë ˆë“œë§ˆë‹¤ ì¡´ì¬.

**5. Native Method Stack**

JNIë¥¼ í†µí•œ ë„¤ì´í‹°ë¸Œ(C/C++) ì½”ë“œ ì‹¤í–‰ ì‹œ ì‚¬ìš©. Android NDK ì½”ë“œê°€ ì—¬ê¸°ì„œ ì‹¤í–‰ëœë‹¤.

### Android ARTì™€ì˜ ì°¨ì´

```
í‘œì¤€ JVM                          Android ART
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
.class ë°”ì´íŠ¸ì½”ë“œ ì‹¤í–‰              .dex ë°”ì´íŠ¸ì½”ë“œ ì‹¤í–‰
HotSpot GC                       Concurrent GC (ì•± ë©ˆì¶¤ ìµœì†Œí™”)
í´ë˜ìŠ¤ ë‹¨ìœ„ ë¡œë”©                    ì•± ì„¤ì¹˜ ì‹œ AOT ì»´íŒŒì¼ (or í˜¼í•©)
í° Heap ì‚¬ìš© ê°€ëŠ¥                  ì•±ë‹¹ Heap ì œí•œ (ë³´í†µ 256~512MB)
```

```kotlin
// Androidì—ì„œ Heap ì œí•œ í™•ì¸
val runtime = Runtime.getRuntime()
val maxMemory = runtime.maxMemory() / 1024 / 1024  // MB ë‹¨ìœ„
Log.d("Memory", "Max heap: ${maxMemory}MB")
```

### ë©”ëª¨ë¦¬ ì˜ì—­ë³„ ì •ë¦¬

| ì˜ì—­ | ì €ì¥ ë‚´ìš© | ìŠ¤ë ˆë“œ ê³µìœ  | GC ëŒ€ìƒ |
|---|---|---|---|
| Method Area | í´ë˜ìŠ¤ ì •ë³´, static, ìƒìˆ˜ | O | X |
| Heap | ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ | O | **O** |
| Stack | ì§€ì—­ë³€ìˆ˜, ë©”ì„œë“œ í”„ë ˆì„ | X (ìŠ¤ë ˆë“œë³„) | X |
| PC Register | í˜„ì¬ ëª…ë ¹ì–´ ì£¼ì†Œ | X | X |
| Native Stack | JNI ë„¤ì´í‹°ë¸Œ ì½”ë“œ | X | X |

## ğŸ”— ê´€ë ¨ ê°œë…

- [[00-CS-ê¸°ì´ˆ/JVM/GC-ê°€ë¹„ì§€-ì»¬ë ‰ì…˜|GC ê°€ë¹„ì§€ ì»¬ë ‰ì…˜]]
- [[00-CS-ê¸°ì´ˆ/JVM/í´ë˜ìŠ¤-ë¡œë”©|í´ë˜ìŠ¤ ë¡œë”©]]
- [[00-CS-ê¸°ì´ˆ/JVM/Dalvik-vs-ART|Dalvik vs ART]]
- [[00-CS-ê¸°ì´ˆ/ë©”ëª¨ë¦¬/ìŠ¤íƒ-vs-í™|ìŠ¤íƒ vs í™]]
- [[00-CS-ê¸°ì´ˆ/ë©”ëª¨ë¦¬/ë©”ëª¨ë¦¬-ë¦­|ë©”ëª¨ë¦¬ ë¦­]]

## ğŸ“š ë” ë³´ê¸°

- [Android Runtime (ART)](https://source.android.com/docs/core/runtime)
- [JVM Specification](https://docs.oracle.com/javase/specs/jvms/se17/html/)

---

**í•µì‹¬ ìš”ì•½:** JVMì€ Method Area(í´ë˜ìŠ¤ ì •ë³´), Heap(ê°ì²´), Stack(ì§€ì—­ë³€ìˆ˜/í”„ë ˆì„)ìœ¼ë¡œ êµ¬ì„±ëœë‹¤. AndroidëŠ” í‘œì¤€ JVM ëŒ€ì‹  ARTë¥¼ ì‚¬ìš©í•˜ë©°, ì•±ë‹¹ Heap í¬ê¸°ê°€ ì œí•œëœë‹¤.
