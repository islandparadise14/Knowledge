---
tags: [CS, ì†Œí”„íŠ¸ì›¨ì–´-ê³µí•™, DI, ì˜ì¡´ì„±-ì£¼ì…, Hilt, Dagger, Koin, Android]
---

# ì˜ì¡´ì„± ì£¼ì… (Dependency Injection)

## ğŸ’¡ í•µì‹¬ ê°œë…

ì˜ì¡´ì„± ì£¼ì…(DI)ì€ ê°ì²´ê°€ í•„ìš”ë¡œ í•˜ëŠ” ì˜ì¡´ì„±ì„ **ì™¸ë¶€ì—ì„œ ìƒì„±í•˜ì—¬ ì „ë‹¬**í•˜ëŠ” ë””ìì¸ íŒ¨í„´ì´ë‹¤. ê°ì²´ ìŠ¤ìŠ¤ë¡œ ì˜ì¡´ì„±ì„ ìƒì„±í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ê²°í•©ë„ê°€ ë‚®ì•„ì§€ê³ , í…ŒìŠ¤íŠ¸ ì‹œ Mockì´ë‚˜ Fake ê°ì²´ë¥¼ ì‰½ê²Œ ì£¼ì…í•  ìˆ˜ ìˆë‹¤.

## ğŸ“Œ ì™œ í•„ìš”í•œê°€?

Androidì—ì„œ ViewModel, Repository, DataSource ë“±ì˜ ê°ì²´ ìƒì„±ê³¼ ìƒëª…ì£¼ê¸° ê´€ë¦¬ëŠ” ë³µì¡í•˜ë‹¤. DIë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ ìƒì„± ë¡œì§ì„ ë¶„ë¦¬í•˜ê³ , í…ŒìŠ¤íŠ¸ ìš©ì´ì„±ê³¼ ì½”ë“œ ì¬ì‚¬ìš©ì„±ì„ í¬ê²Œ ë†’ì¼ ìˆ˜ ìˆë‹¤.

## ğŸ” ìì„¸íˆ

### DI ì—†ëŠ” ì½”ë“œ vs DI ì ìš© ì½”ë“œ

```kotlin
// âŒ DI ì—†ìŒ - ì§ì ‘ ìƒì„± (ê°•í•œ ê²°í•©)
class UserViewModel : ViewModel() {
    private val api = RetrofitClient.create(UserApi::class.java)
    private val db = AppDatabase.getInstance()
    private val repository = UserRepositoryImpl(api, db.userDao())
}

// âœ… DI ì ìš© - ì™¸ë¶€ì—ì„œ ì£¼ì… (ëŠìŠ¨í•œ ê²°í•©)
class UserViewModel(
    private val repository: UserRepository  // ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
) : ViewModel()
```

### DIì˜ ì„¸ ê°€ì§€ ë°©ì‹

#### 1. ìƒì„±ì ì£¼ì… (Constructor Injection) - ê¶Œì¥

```kotlin
class UserRepository @Inject constructor(
    private val api: UserApi,
    private val dao: UserDao
) {
    suspend fun getUser(id: String): User = /* ... */
}
```

#### 2. í•„ë“œ ì£¼ì… (Field Injection)

```kotlin
@AndroidEntryPoint
class MainActivity : AppCompatActivity() {
    @Inject lateinit var analytics: AnalyticsTracker  // í•„ë“œ ì£¼ì…
}
```

#### 3. ë©”ì„œë“œ ì£¼ì… (Method Injection)

```kotlin
class ImageLoader {
    private lateinit var cache: ImageCache

    @Inject
    fun setCache(cache: ImageCache) {
        this.cache = cache
    }
}
```

### Hilt (Google ê³µì‹ ê¶Œì¥)

Android ì „ìš© DI ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, Dagger ìœ„ì— êµ¬ì¶•ë˜ì–´ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ë¥¼ ì¤„ì˜€ë‹¤.

```kotlin
// 1. Application í´ë˜ìŠ¤
@HiltAndroidApp
class MyApp : Application()

// 2. ëª¨ë“ˆ ì •ì˜
@Module
@InstallIn(SingletonComponent::class)
object NetworkModule {
    @Provides
    @Singleton
    fun provideRetrofit(): Retrofit =
        Retrofit.Builder()
            .baseUrl("https://api.example.com/")
            .addConverterFactory(GsonConverterFactory.create())
            .build()

    @Provides
    fun provideUserApi(retrofit: Retrofit): UserApi =
        retrofit.create(UserApi::class.java)
}

// ì¸í„°í˜ì´ìŠ¤ ë°”ì¸ë”©
@Module
@InstallIn(SingletonComponent::class)
abstract class RepositoryModule {
    @Binds
    abstract fun bindUserRepository(impl: UserRepositoryImpl): UserRepository
}

// 3. ViewModelì—ì„œ ì‚¬ìš©
@HiltViewModel
class UserViewModel @Inject constructor(
    private val repository: UserRepository
) : ViewModel()

// 4. Activity/Fragmentì—ì„œ ì‚¬ìš©
@AndroidEntryPoint
class UserFragment : Fragment() {
    private val viewModel: UserViewModel by viewModels()
}
```

### Koin (ê²½ëŸ‰ DI)

ë¦¬í”Œë ‰ì…˜ ê¸°ë°˜ì˜ ì„œë¹„ìŠ¤ ë¡œì¼€ì´í„°ë¡œ, ì„¤ì •ì´ ê°„ë‹¨í•˜ë‹¤.

```kotlin
// ëª¨ë“ˆ ì •ì˜
val appModule = module {
    single<UserRepository> { UserRepositoryImpl(get(), get()) }
    viewModel { UserViewModel(get()) }
}

// ì‹œì‘
class MyApp : Application() {
    override fun onCreate() {
        super.onCreate()
        startKoin {
            androidContext(this@MyApp)
            modules(appModule)
        }
    }
}

// ì‚¬ìš©
class UserFragment : Fragment() {
    private val viewModel: UserViewModel by viewModel()
}
```

### ìˆ˜ë™ DI (Manual DI)

í”„ë ˆì„ì›Œí¬ ì—†ì´ ì§ì ‘ êµ¬í˜„í•˜ëŠ” ë°©ì‹. ì†Œê·œëª¨ í”„ë¡œì íŠ¸ë‚˜ í•™ìŠµ ëª©ì ì— ì í•©í•˜ë‹¤.

```kotlin
// DI ì»¨í…Œì´ë„ˆ
class AppContainer(context: Context) {
    private val retrofit = Retrofit.Builder().baseUrl("...").build()
    private val api = retrofit.create(UserApi::class.java)
    private val db = AppDatabase.getInstance(context)

    val userRepository: UserRepository = UserRepositoryImpl(api, db.userDao())
}

// Applicationì—ì„œ ê´€ë¦¬
class MyApp : Application() {
    lateinit var container: AppContainer
    override fun onCreate() {
        super.onCreate()
        container = AppContainer(this)
    }
}
```

### Hilt vs Koin ë¹„êµ

| í•­ëª© | Hilt | Koin |
|------|------|------|
| ê¸°ë°˜ | ì»´íŒŒì¼ íƒ€ì„ ì½”ë“œ ìƒì„± (Dagger) | ëŸ°íƒ€ì„ ë¦¬í”Œë ‰ì…˜ |
| ì˜¤ë¥˜ ê°ì§€ | ì»´íŒŒì¼ íƒ€ì„ | ëŸ°íƒ€ì„ |
| ì„±ëŠ¥ | ëŸ°íƒ€ì„ ì„±ëŠ¥ ìš°ìˆ˜ | ì•± ì‹œì‘ ì‹œ ì•½ê°„ ëŠë¦¼ |
| í•™ìŠµ ê³¡ì„  | ë†’ìŒ | ë‚®ìŒ |
| Google ì§€ì› | ê³µì‹ ê¶Œì¥ | ì„œë“œíŒŒí‹° |
| ë©€í‹°ëª¨ë“ˆ | ìš°ìˆ˜ | ë³´í†µ |

## ğŸ”— ê´€ë ¨ ê°œë…

- [[00-CS-ê¸°ì´ˆ/ì†Œí”„íŠ¸ì›¨ì–´-ê³µí•™/SOLID-ì›ì¹™|SOLID ì›ì¹™ (DIP)]]
- [[00-CS-ê¸°ì´ˆ/ì†Œí”„íŠ¸ì›¨ì–´-ê³µí•™/ê²°í•©ë„ì™€-ì‘ì§‘ë„|ê²°í•©ë„ì™€ ì‘ì§‘ë„]]
- [[00-CS-ê¸°ì´ˆ/ì†Œí”„íŠ¸ì›¨ì–´-ê³µí•™/OOP-ê°ì²´ì§€í–¥|OOP ê°ì²´ì§€í–¥]]
- [[00-CS-ê¸°ì´ˆ/ì†Œí”„íŠ¸ì›¨ì–´-ê³µí•™/ì¶”ìƒí™”ì™€-ìº¡ìŠí™”|ì¶”ìƒí™”ì™€ ìº¡ìŠí™”]]

## ğŸ“š ë” ë³´ê¸°

- [Android Developers - Dependency Injection](https://developer.android.com/training/dependency-injection)
- [Hilt ê³µì‹ ë¬¸ì„œ](https://dagger.dev/hilt/)
- [Koin ê³µì‹ ë¬¸ì„œ](https://insert-koin.io/)

---

**í•µì‹¬ ìš”ì•½:** ì˜ì¡´ì„± ì£¼ì…ì€ ê°ì²´ ìƒì„±ì„ ì™¸ë¶€ì— ìœ„ì„í•˜ì—¬ ê²°í•©ë„ë¥¼ ë‚®ì¶”ëŠ” íŒ¨í„´ì´ë©°, Androidì—ì„œëŠ” Hilt(ê³µì‹ ê¶Œì¥) ë˜ëŠ” Koinì„ ì‚¬ìš©í•´ ViewModel, Repository ë“±ì˜ ì˜ì¡´ì„±ì„ ê´€ë¦¬í•œë‹¤.
