---
tags: [kotlin, extension-function]
---

# í™•ì¥ í•¨ìˆ˜

## ğŸ’¡ í•µì‹¬ ê°œë…

**í™•ì¥ í•¨ìˆ˜(Extension Function)**ëŠ” ê¸°ì¡´ í´ë˜ìŠ¤ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. ë§ˆì¹˜ ì›ë˜ í´ë˜ìŠ¤ì— ìˆë˜ ê²ƒì²˜ëŸ¼ í˜¸ì¶œ ê°€ëŠ¥í•˜ë‹¤.

## ğŸ“Œ ì™œ í•„ìš”í•œê°€?

Third-party ë¼ì´ë¸ŒëŸ¬ë¦¬ë‚˜ ê¸°ë³¸ í´ë˜ìŠ¤(String, List ë“±)ì— ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. Javaì˜ ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ íŒ¨í„´ë³´ë‹¤ í›¨ì”¬ ì§ê´€ì ì´ë‹¤.

## ğŸ” ìì„¸íˆ

### ê¸°ë³¸ ì‚¬ìš©ë²•

```kotlin
// Stringì— í•¨ìˆ˜ ì¶”ê°€
fun String.isValidEmail(): Boolean {
    return this.contains("@") && this.contains(".")
}

// ì‚¬ìš©
"test@example.com".isValidEmail()  // true
"invalid".isValidEmail()  // false

// Listì— í•¨ìˆ˜ ì¶”ê°€
fun <T> List<T>.secondOrNull(): T? {
    return if (this.size >= 2) this[1] else null
}

listOf(1, 2, 3).secondOrNull()  // 2
listOf(1).secondOrNull()  // null
```

### nullable í™•ì¥

```kotlin
// nullable íƒ€ì…ì—ë„ í™•ì¥ ê°€ëŠ¥
fun String?.orEmpty(): String {
    return this ?: ""
}

val name: String? = null
name.orEmpty()  // ""
```

### í™•ì¥ í”„ë¡œí¼í‹°

```kotlin
// í•¨ìˆ˜ë¿ë§Œ ì•„ë‹ˆë¼ í”„ë¡œí¼í‹°ë„ í™•ì¥ ê°€ëŠ¥
val String.lastChar: Char
    get() = this[length - 1]

"Kotlin".lastChar  // 'n'

// nullable í™•ì¥ í”„ë¡œí¼í‹°
val String?.isNullOrEmpty: Boolean
    get() = this == null || this.isEmpty()
```

### Companion Object í™•ì¥

```kotlin
class User {
    companion object {
        const val DEFAULT_AGE = 0
    }
}

// Companion objectì— í•¨ìˆ˜ ì¶”ê°€
fun User.Companion.create(name: String): User {
    return User(name, DEFAULT_AGE)
}

// ì‚¬ìš©
User.create("ë¯¼íŠ¸")
```

### ë™ì‘ ì›ë¦¬

**ì •ì  ë””ìŠ¤íŒ¨ì¹˜**

```kotlin
open class Shape
class Circle : Shape()

fun Shape.getName() = "Shape"
fun Circle.getName() = "Circle"

val shape: Shape = Circle()
println(shape.getName())  // "Shape" (ì •ì  íƒ€ì… ê¸°ì¤€)

// í™•ì¥ í•¨ìˆ˜ëŠ” ì˜¤ë²„ë¼ì´ë“œ ì•ˆ ë¨!
```

**Javaë¡œ ë³€í™˜**

```kotlin
fun String.isValidEmail(): Boolean {
    return this.contains("@")
}

// Javaë¡œ ë³€í™˜ ì‹œ
public static boolean isValidEmail(String $this) {
    return $this.contains("@");
}

// ì‹¤ì œë¡œëŠ” static ë©”ì„œë“œ
```

### ì£¼ì˜ì‚¬í•­

**1. ë©¤ë²„ í•¨ìˆ˜ê°€ ìš°ì„ **

```kotlin
class MyClass {
    fun foo() {
        println("Member")
    }
}

fun MyClass.foo() {
    println("Extension")
}

MyClass().foo()  // "Member" (ë©¤ë²„ í•¨ìˆ˜ê°€ ìš°ì„ )
```

**2. private ë©¤ë²„ ì ‘ê·¼ ë¶ˆê°€**

```kotlin
class User {
    private val secret = "secret"
}

fun User.getSecret(): String {
    // return this.secret  // ERROR: ì ‘ê·¼ ë¶ˆê°€
    return "cannot access"
}
```

**3. í™•ì¥ í•¨ìˆ˜ëŠ” ì˜¤ë²„ë¼ì´ë“œ ì•ˆ ë¨**

```kotlin
open class Parent
class Child : Parent()

fun Parent.foo() = "parent"
fun Child.foo() = "child"

val obj: Parent = Child()
println(obj.foo())  // "parent" (ëŸ°íƒ€ì„ íƒ€ì…ì´ ì•„ë‹Œ ì„ ì–¸ íƒ€ì… ê¸°ì¤€)
```

## ğŸ’» ì‹¤ì „ ì˜ˆì œ

### Android Context í™•ì¥

```kotlin
// Toast ê°„í¸í•˜ê²Œ
fun Context.showToast(message: String, duration: Int = Toast.LENGTH_SHORT) {
    Toast.makeText(this, message, duration).show()
}

// Activityì—ì„œ
showToast("Hello!")

// dp to px ë³€í™˜
val Int.dp: Int
    get() = (this * Resources.getSystem().displayMetrics.density).toInt()

// ì‚¬ìš©
val margin = 16.dp
```

### View í™•ì¥

```kotlin
fun View.show() {
    visibility = View.VISIBLE
}

fun View.hide() {
    visibility = View.GONE
}

fun View.invisible() {
    visibility = View.INVISIBLE
}

// ì‚¬ìš©
textView.show()
progressBar.hide()
```

### Fragment í™•ì¥

```kotlin
inline fun <reified T : ViewModel> Fragment.viewModel(
    noinline ownerProducer: () -> ViewModelStoreOwner = { this },
    noinline factoryProducer: (() -> ViewModelProvider.Factory)? = null
): Lazy<T> {
    return ViewModelLazy(
        T::class,
        { ownerProducer().viewModelStore },
        { factoryProducer?.invoke() ?: defaultViewModelProviderFactory }
    )
}

// ì‚¬ìš©
class MyFragment : Fragment() {
    private val viewModel: MyViewModel by viewModel()
}
```

### Flow í™•ì¥

```kotlin
fun <T> Flow<T>.throttleFirst(windowDuration: Long): Flow<T> = flow {
    var lastEmissionTime = 0L
    collect { value ->
        val currentTime = System.currentTimeMillis()
        if (currentTime - lastEmissionTime >= windowDuration) {
            lastEmissionTime = currentTime
            emit(value)
        }
    }
}

// ì‚¬ìš©
clickFlow.throttleFirst(300)  // 300ms ì•ˆì— ì¤‘ë³µ í´ë¦­ ë°©ì§€
```

### String í™•ì¥

```kotlin
fun String.toIntOrDefault(default: Int = 0): Int {
    return this.toIntOrNull() ?: default
}

fun String.isValidPhoneNumber(): Boolean {
    return this.matches(Regex("^010-\\d{4}-\\d{4}$"))
}

fun String.ellipsize(maxLength: Int): String {
    return if (this.length > maxLength) {
        this.take(maxLength - 3) + "..."
    } else {
        this
    }
}

// ì‚¬ìš©
"123".toIntOrDefault()  // 123
"abc".toIntOrDefault()  // 0
"Long text here".ellipsize(10)  // "Long te..."
```

### LiveData í™•ì¥

```kotlin
fun <T> LiveData<T>.observeOnce(owner: LifecycleOwner, observer: (T) -> Unit) {
    observe(owner, object : Observer<T> {
        override fun onChanged(value: T) {
            observer(value)
            removeObserver(this)
        }
    })
}

// ì‚¬ìš©
viewModel.userData.observeOnce(viewLifecycleOwner) { user ->
    // í•œ ë²ˆë§Œ ì‹¤í–‰
}
```

### Collection í™•ì¥

```kotlin
fun <T> List<T>.update(index: Int, item: T): List<T> {
    return this.toMutableList().apply {
        set(index, item)
    }
}

fun <K, V> Map<K, V>.toggle(key: K, value: V): Map<K, V> {
    return if (containsKey(key)) {
        this - key
    } else {
        this + (key to value)
    }
}
```

## ğŸ”— ê´€ë ¨ ê°œë…

- [[01-Kotlin/ê¸°ë³¸ë¬¸ë²•/í•¨ìˆ˜]]
- [[01-Kotlin/í•¨ìˆ˜í˜•-í”„ë¡œê·¸ë˜ë°/ì¸ë¼ì¸-í•¨ìˆ˜]]
- [[01-Kotlin/í•¨ìˆ˜í˜•-í”„ë¡œê·¸ë˜ë°/Scope-Functions]]

## ğŸ“š ë” ë³´ê¸°

- [Kotlin Docs - Extensions](https://kotlinlang.org/docs/extensions.html)

---

**í•µì‹¬ ìš”ì•½:** í™•ì¥ í•¨ìˆ˜ë¡œ ê¸°ì¡´ í´ë˜ìŠ¤ì— ê¸°ëŠ¥ ì¶”ê°€. ì •ì  ë””ìŠ¤íŒ¨ì¹˜. ë©¤ë²„ í•¨ìˆ˜ê°€ ìš°ì„ .
