---
tags: [kotlin, functional-programming, inline, optimization]
---

# ì¸ë¼ì¸ í•¨ìˆ˜ (Inline Functions)

## ğŸ’¡ í•µì‹¬ ê°œë…

**inline** í‚¤ì›Œë“œëŠ” ê³ ì°¨ í•¨ìˆ˜ì˜ ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œë¥¼ ì œê±°í•˜ëŠ” ìµœì í™” ê¸°ë²•ì´ë‹¤. ì»´íŒŒì¼ ì‹œ í•¨ìˆ˜ ë³¸ë¬¸ê³¼ ëŒë‹¤ê°€ í˜¸ì¶œ ì§€ì ì— ì§ì ‘ ì‚½ì…ëœë‹¤.

## ğŸ“Œ ì™œ í•„ìš”í•œê°€?

ê³ ì°¨ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ **ëŒë‹¤ ê°ì²´ê°€ ë§¤ë²ˆ ìƒì„±**ëœë‹¤:

```kotlin
fun notInlined(block: () -> Unit) {
    block()
}

// í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ëŒë‹¤ ê°ì²´ ìƒì„±
notInlined { println("Hello") }
```

**ë¬¸ì œì :**
- ë§¤ë²ˆ ê°ì²´ í• ë‹¹ â†’ ë©”ëª¨ë¦¬ ì˜¤ë²„í—¤ë“œ
- ê°„ì ‘ í˜¸ì¶œ â†’ ì„±ëŠ¥ ì €í•˜
- ë°˜ë³µë¬¸ ì•ˆì—ì„œ í˜¸ì¶œí•˜ë©´ ë” ì‹¬ê°í•´ì§

## ğŸ” ìì„¸íˆ

### ê¸°ë³¸ ì‚¬ìš©ë²•

```kotlin
inline fun inlined(block: () -> Unit) {
    block()
}

// í˜¸ì¶œ
inlined { println("Hello") }

// ì»´íŒŒì¼ í›„ (ê°œë…ì ìœ¼ë¡œ)
println("Hello")  // ëŒë‹¤ê°€ ì§ì ‘ ì‚½ì…ë¨
```

### ë°”ì´íŠ¸ì½”ë“œ ë¹„êµ

```kotlin
// ì›ë³¸ ì½”ë“œ
inline fun measure(block: () -> Unit) {
    val start = System.currentTimeMillis()
    block()
    println("Took: ${System.currentTimeMillis() - start}ms")
}

fun main() {
    measure {
        Thread.sleep(100)
    }
}

// ì»´íŒŒì¼ í›„ (ì‹¤ì œë¡œëŠ” ì´ë ‡ê²Œ ë¨)
fun main() {
    val start = System.currentTimeMillis()
    Thread.sleep(100)
    println("Took: ${System.currentTimeMillis() - start}ms")
}
```

### noinline

ì¼ë¶€ ëŒë‹¤ë§Œ ì¸ë¼ì¸ ì œì™¸:

```kotlin
inline fun doSomething(
    inlinedBlock: () -> Unit,
    noinline storedBlock: () -> Unit  // ì €ì¥í•´ì•¼ í•˜ë©´ noinline
) {
    inlinedBlock()
    someList.add(storedBlock)  // ê°ì²´ë¡œ ì €ì¥
}
```

**noinlineì´ í•„ìš”í•œ ê²½ìš°:**
- ëŒë‹¤ë¥¼ ë³€ìˆ˜ì— ì €ì¥í•´ì•¼ í•  ë•Œ
- ëŒë‹¤ë¥¼ ë‹¤ë¥¸ non-inline í•¨ìˆ˜ì— ì „ë‹¬í•  ë•Œ

### crossinline

ë¹„ì§€ì—­ ë°˜í™˜ì„ ê¸ˆì§€:

```kotlin
inline fun runOnThread(crossinline block: () -> Unit) {
    Thread {
        block()  // ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‹¤í–‰
    }.start()
}

runOnThread {
    // return  // ì»´íŒŒì¼ ì—ëŸ¬! crossinlineì´ë¼ ë¹„ì§€ì—­ ë°˜í™˜ ë¶ˆê°€
    return@runOnThread  // ì´ê±´ ê°€ëŠ¥
}
```

**í•„ìš”í•œ ì´ìœ :** ëŒë‹¤ê°€ ë‹¤ë¥¸ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸(ìŠ¤ë ˆë“œ ë“±)ì—ì„œ ì‹¤í–‰ë  ë•Œ, ë°”ê¹¥ í•¨ìˆ˜ë¡œì˜ returnì´ ì˜ë¯¸ê°€ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.

### reified íƒ€ì… íŒŒë¼ë¯¸í„°

inlineê³¼ í•¨ê»˜ ì“°ë©´ **ëŸ°íƒ€ì„ì— ì œë„¤ë¦­ íƒ€ì… ì •ë³´ ìœ ì§€**:

```kotlin
// ì¼ë°˜ í•¨ìˆ˜ - íƒ€ì… ì†Œê±°ë¡œ ë¶ˆê°€ëŠ¥
fun <T> isType(value: Any): Boolean {
    return value is T  // ì»´íŒŒì¼ ì—ëŸ¬!
}

// inline + reified - ê°€ëŠ¥
inline fun <reified T> isType(value: Any): Boolean {
    return value is T  // OK!
}

isType<String>("hello")  // true
isType<Int>("hello")     // false
```

**Android í™œìš© ì˜ˆ:**

```kotlin
// ì¼ë°˜ì ì¸ ë°©ë²•
startActivity(Intent(this, MainActivity::class.java))

// reified í™œìš©
inline fun <reified T : Activity> Context.startActivity() {
    startActivity(Intent(this, T::class.java))
}

// ì‚¬ìš©
startActivity<MainActivity>()
```

```kotlin
// Gsonê³¼ í•¨ê»˜
inline fun <reified T> Gson.fromJson(json: String): T {
    return fromJson(json, T::class.java)
}

val user: User = gson.fromJson(jsonString)
```

## ğŸ’» ì‹¤ì „ ì˜ˆì œ

### í‘œì¤€ ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ inline í•¨ìˆ˜ë“¤

```kotlin
// ëª¨ë‘ inlineìœ¼ë¡œ ì •ì˜ë¨
public inline fun <T> T.apply(block: T.() -> Unit): T
public inline fun <T> T.also(block: (T) -> Unit): T
public inline fun <T, R> T.let(block: (T) -> R): R
public inline fun <T, R> T.run(block: T.() -> R): R
public inline fun <T> Iterable<T>.filter(predicate: (T) -> Boolean): List<T>
public inline fun <T, R> Iterable<T>.map(transform: (T) -> R): List<R>
```

ê·¸ë˜ì„œ `apply`, `let`, `also`, `run`, `map`, `filter` ë“±ì„ ììœ ë¡­ê²Œ ì‚¬ìš©í•´ë„ ì„±ëŠ¥ ê±±ì •ì´ ì—†ë‹¤.

### ì¸¡ì • ìœ í‹¸ë¦¬í‹°

```kotlin
inline fun <T> measureTimeMillis(block: () -> T): Pair<T, Long> {
    val start = System.currentTimeMillis()
    val result = block()
    return result to (System.currentTimeMillis() - start)
}

val (data, time) = measureTimeMillis {
    repository.loadData()
}
println("Loaded in ${time}ms")
```

### ì•ˆì „í•œ ì‹¤í–‰

```kotlin
inline fun <T> tryOrNull(block: () -> T): T? {
    return try {
        block()
    } catch (e: Exception) {
        null
    }
}

val user = tryOrNull { api.getUser(id) }
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

### inline ì‚¬ìš© ê°€ì´ë“œ

| ìƒí™© | inline ì‚¬ìš© |
|------|-------------|
| ëŒë‹¤ë¥¼ ë°›ëŠ” ì‘ì€ í•¨ìˆ˜ | âœ… ê¶Œì¥ |
| ë°˜ë³µë¬¸ì—ì„œ ìì£¼ í˜¸ì¶œ | âœ… ê¶Œì¥ |
| reified íƒ€ì… í•„ìš” | âœ… í•„ìˆ˜ |
| í•¨ìˆ˜ ë³¸ë¬¸ì´ í° ê²½ìš° | âŒ ë°”ì´íŠ¸ì½”ë“œ ì¦ê°€ |
| ëŒë‹¤ ì—†ëŠ” í•¨ìˆ˜ | âŒ ì˜ë¯¸ ì—†ìŒ |
| ì¬ê·€ í•¨ìˆ˜ | âŒ ì¸ë¼ì¸ ë¶ˆê°€ |

### ì œí•œ ì‚¬í•­

```kotlin
// 1. í•¨ìˆ˜ ë³¸ë¬¸ì´ í¬ë©´ ë°”ì´íŠ¸ì½”ë“œ ì¦ê°€
inline fun veryLargeFunction() {  // ê²½ê³  ë°œìƒ
    // 100ì¤„ ì´ìƒì˜ ì½”ë“œ...
}

// 2. public inline í•¨ìˆ˜ëŠ” internal/private ë©¤ë²„ ì ‘ê·¼ ë¶ˆê°€
class MyClass {
    private val secret = "hidden"

    inline fun expose() {
        println(secret)  // ì—ëŸ¬!
    }
}
```

## ğŸ”— ê´€ë ¨ ê°œë…

- [[01-Kotlin/í•¨ìˆ˜í˜•-í”„ë¡œê·¸ë˜ë°/ê³ ì°¨í•¨ìˆ˜]]
- [[01-Kotlin/í•¨ìˆ˜í˜•-í”„ë¡œê·¸ë˜ë°/ëŒë‹¤-í‘œí˜„ì‹]]
- [[01-Kotlin/í•¨ìˆ˜í˜•-í”„ë¡œê·¸ë˜ë°/Scope-Functions]]

## ğŸ“š ë” ë³´ê¸°

- [Kotlin Docs - Inline Functions](https://kotlinlang.org/docs/inline-functions.html)

---

**í•µì‹¬ ìš”ì•½:** inlineìœ¼ë¡œ ëŒë‹¤ ê°ì²´ ìƒì„± ì˜¤ë²„í—¤ë“œ ì œê±°. noinlineì€ ì €ì¥ìš©, crossinlineì€ ë¹„ì§€ì—­ ë°˜í™˜ ê¸ˆì§€. reifiedë¡œ ëŸ°íƒ€ì„ íƒ€ì… ì •ë³´ ìœ ì§€.